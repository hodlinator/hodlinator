# 2025 October-December

## Large

### ASMap

As noted in my previous report, after the v30 release I planned to help push forward an existing older initiative to get it in a (more) releasable state. @fjahr held a session on ASMap during CoreDev that I lurked. After checking out the PRs he had, I dove in.

 * First contact: <https://github.com/bitcoin/bitcoin/pull/33026#pullrequestreview-3441618331>
     * ðŸŒŸ Uncovered a bug: <https://github.com/bitcoin/bitcoin/pull/33026#discussion_r2527777820>
 * ðŸŒŸ Suggested breaking out `bool` -> `byte` refactor from larger PR in <https://github.com/bitcoin/bitcoin/pull/33026#pullrequestreview-3466738494> which was promptly agreed upon by PR author.
 * Reviewed embedding PR: <https://github.com/bitcoin/bitcoin/pull/28792#pullrequestreview-3448784895> (lots of comments, mostly nits)
     * Repeated review and concept ACK, verifying low impact of embedding binary blob on build times with ccache cleared: <https://github.com/bitcoin/bitcoin/pull/28792#pullrequestreview-3492585142>
 * Reviewed bits -> bytes refactor which was broken out:
     * <https://github.com/bitcoin/bitcoin/pull/33878#pullrequestreview-3473921944>
     * <https://github.com/bitcoin/bitcoin/pull/33878#pullrequestreview-3486433210>
         * ðŸŒŸ Uncovered way to simplify bit-shifting code: <https://github.com/bitcoin/bitcoin/pull/33878#discussion_r2545416624>, and ðŸŒŸðŸŒŸ further simplified it in <https://github.com/bitcoin/bitcoin/pull/33878#discussion_r2549545939>
     * Earned IRC shoutout during weekly IRC meeting <https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2025-11-20#1173343;>
     * Developed test to verify integrity of the `bool` -> `byte` transition: <https://github.com/bitcoin/bitcoin/pull/33878#pullrequestreview-3503770177> (It tests minimal sets of explicit asmap binary patterns, primarily in <https://github.com/bitcoin/bitcoin/commit/cf34bb9806e95116d4b65b6dc80dc11a1f723a51>, before the `bool` -> `byte` change is done).
 * Reviewed change to contrib script: <https://github.com/bitcoin/bitcoin/pull/33939#pullrequestreview-3511709141>
 * Participated in the asmap-data generation process: <https://github.com/asmap/asmap-data/issues/36#issuecomment-3613071395>
     * PR review for merging data from above generation process: <https://github.com/asmap/asmap-data/pull/38#pullrequestreview-3547352533>
 * Own tiny PR to remove small footgun in contrib tool: <https://github.com/bitcoin/bitcoin/pull/34089>
 * kartograf repo: Own PR to refresh README <https://github.com/asmap/kartograf/pull/107>
 * BTC Transcripts repo: Reviewed ASMap CoreDev session amendment <https://github.com/bitcointranscripts/bitcointranscripts/pull/594#pullrequestreview-3449492689>

I don't think ASMap is a silver bullet, and we might want to use it for a subset of our clearnet peers, rather than default to using it for all. But I think having it in our toolbox and more readily available through embedding it does make the network of nodes more resilient (vs status quo of users having to download the asmap file separately from the Bitcoin Core install).


## Medium

### Held CoreDev sessions

* Spark sessions on Headers Sync x3. (Brain fried on 3rd session ðŸ« ). No major disagreements about adding a cache, seemed to help recruit at least one newer contributor to work in this subdomain.
* Improvised Debugging Workshop session (<https://btctranscripts.com/bitcoin-core-dev-tech/2025-10/debugging>)

### Reviewed blockpart REST API

The previous quarter I pushed back on @romanz's new Bitcoin Core Transaction Location index <https://github.com/bitcoin/bitcoin/pull/32541#pullrequestreview-3189055673>. This quarter I helped review the much more scaled down version which instead uses an external index and only exposes reading bytes from a block in the REST interface.

* <https://github.com/bitcoin/bitcoin/pull/33657#pullrequestreview-3492740506>
* <https://github.com/bitcoin/bitcoin/pull/33657#pullrequestreview-3499037428>
* ðŸŒŸ Uncovered synthetic benchmark being too synthetic: <https://github.com/bitcoin/bitcoin/pull/33657#issuecomment-3609114450>
* Also reviewed follow-up PR: <https://github.com/bitcoin/bitcoin/pull/34074#pullrequestreview-3582086127>, <https://github.com/bitcoin/bitcoin/pull/34074#pullrequestreview-3586793647>

### Reviewed `util::Result` improvements, `util::Expected` introduction

 * Used `std::variant` as return value in suggestion for the above block part PR (<https://github.com/bitcoin/bitcoin/pull/33657#discussion_r2584393520>)...
 * ...that may have contributed to `util::Expected` being introduced (mimicking `std::expected` which is not available yet in the project since it's C++23 <https://en.cppreference.com/w/cpp/utility/expected.html>)... which I reviewed: <https://github.com/bitcoin/bitcoin/pull/34006#pullrequestreview-3544455114>
 * Spent several non-contiguous days on slightly muddled attempts to review the `util::Result` improvements PR. Wish I was quicker to grasp the defining aspects justifying the proposed `util::Result` over `util::Expected` quicker, but at least now I'm on board for the most part.
    * <https://github.com/bitcoin/bitcoin/pull/25665#issuecomment-3617021123>
    * <https://github.com/bitcoin/bitcoin/pull/25665#pullrequestreview-2343976961>
    * <https://github.com/bitcoin/bitcoin/pull/25665#pullrequestreview-3573338179>
 * Reviewed "Add some more Unexpected and Expected methods" <https://github.com/bitcoin/bitcoin/pull/34032#pullrequestreview-3561476416>, <https://github.com/bitcoin/bitcoin/pull/34032#pullrequestreview-3566334104>

### Own PR - "http: Make server shutdown more robust"

Refreshed PR to be more mergable ahead of CoreDev: <https://github.com/bitcoin/bitcoin/pull/31929#issuecomment-3403587613>. Involved getting to know Valgrind a bit and experimenting with reducing memory leaks during shutdown, currently we filter some of them out, instead of avoiding leaks. ðŸ’¡ Future work idea: properly free more on shutdown instead of leaking.

### Reviewed "log: avoid collecting `GetSerializeSize` data when compact block logging is disabled"

<https://github.com/bitcoin/bitcoin/pull/33738#pullrequestreview-3595056869>

Proposed alternative approach with benchmarks, still needs following up on.

### Reviewed "validation: Improve warnings in case of chain corruption"

Slightly frustrated with myself an not having/taking time to follow through here. ðŸ¤¦ But still signs of learning.

* Tried to help reason through approach: <https://github.com/bitcoin/bitcoin/pull/33553#issuecomment-3406488480>
* Started work on functional test: <https://github.com/bitcoin/bitcoin/pull/33553#discussion_r2415036002>
* Fished for feedback on minor improvement: <https://github.com/bitcoin/bitcoin/issues/26391#issuecomment-3646548064>

### Improved my debugging support PR (continued)

Added support for modifying a function test code (re)start node statement to specify that it should attach a debugger <https://github.com/bitcoin/bitcoin/pull/31723#issuecomment-3441238061>

Several updates to the PR in response to feedback and inspiration from other PRs: <https://github.com/bitcoin/bitcoin/pull/31723#issuecomment-3655043501>

### ðŸŒŸ BIPs repo debut: Own PR - Clarified wording and notation in BIP53

Regarding light clients, merkle trees and 64-byte transactions: <https://github.com/bitcoin/bips/pull/2034>


## Small

### Own PRs

* doc, ci: Make the max number of commits tested explicit: <https://github.com/bitcoin/bitcoin/pull/33909>
* doc: Improve CI docs on env and qemu-user-static: <https://github.com/bitcoin/bitcoin/pull/33887>
* qa: Account for unset errno in ConnectionResetError: <https://github.com/bitcoin/bitcoin/pull/33875> (One-short merge ðŸ”«)
* qa: Clarify assert_start_raises_init_error output: <https://github.com/bitcoin/bitcoin/pull/32929>
    * Fixes issue introduced by another PR I didn't review: <https://github.com/bitcoin/bitcoin/pull/33702#discussion_r2585288311>

### Reviews

* build: "Drop support for EOL macOS 13": <https://github.com/bitcoin/bitcoin/pull/33489#pullrequestreview-3278413474>, <https://github.com/bitcoin/bitcoin/pull/33489#pullrequestreview-3279511439>, <https://github.com/bitcoin/bitcoin/pull/33489#pullrequestreview-3287946924>
* ci: "clear out space on CentOS, depends, gui GHA job": <https://github.com/bitcoin/bitcoin/pull/33514#pullrequestreview-3303220896>
* ci: "Pin native native tests on cross-builds to same commit" <https://github.com/bitcoin/bitcoin/pull/34080#pullrequestreview-3587725439>
* ci: "Add macOS cross task for arm64-apple-darwin" <https://github.com/bitcoin/bitcoin/pull/33549#pullrequestreview-3334496537>
* clang-format: "Set InsertNewlineAtEOF: true" <https://github.com/bitcoin/bitcoin/pull/33896#pullrequestreview-3476584168>
* doc: "doc: Add x86_64-w64-mingw32ucrt triplet to depends/README.md": <https://github.com/bitcoin/bitcoin/pull/33857#pullrequestreview-3534935501>
* fuzz: "fuzz: exercise ComputeMerkleRoot without mutated parameter" <https://github.com/bitcoin/bitcoin/pull/34050#pullrequestreview-3567578900>
* merkle: minor optimization to avoid allocations: <https://github.com/bitcoin/bitcoin/pull/32497#pullrequestreview-3526806887>
* merkle: removal of dead code "migrate path arg to reference and drop unused args": <https://github.com/bitcoin/bitcoin/pull/33805#pullrequestreview-3540270081>
* net: "improve the interface around FindNode() and avoid a recursive mutex lock" <https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-3290340107>
* net: ðŸŒŸ Spotted missing thread safety annotation - "make m_nodes_mutex non-recursive": <https://github.com/bitcoin/bitcoin/pull/32394#discussion_r2433600255>
* p2p: potential DoS vector for CMPCTBLOCK: <https://github.com/bitcoin/bitcoin/pull/32606#pullrequestreview-3382451037>
* refactor: workaround that was ultimately solved by fixing Clang -> Windows code generation: "throw std::string_view instead of const char* in constexpr/consteval functions" <https://github.com/bitcoin/bitcoin/pull/33569#pullrequestreview-3313395594>
* util: `Assert()` etc improvement: <https://github.com/bitcoin/bitcoin/pull/33785#pullrequestreview-3427192513>
* validation: Reviewed/concept discussion: <https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3364452726>
* validation: Tried to reason around assumevalid being ignored during -reindex <https://github.com/bitcoin/bitcoin/pull/33854#issuecomment-3520773269>
* windows: "Modernize use of UTF-8 in Windows code": <https://github.com/bitcoin/bitcoin/pull/32380#pullrequestreview-3307401839>

### Misc

* ci: Investigated GitHub artifact sizes: <https://github.com/bitcoin/bitcoin/pull/32182#issuecomment-3355516795>. Brought it up during CoreDev in Frankfurt. IIRC it's not a stretched resource, so not much interest in optimizing.
